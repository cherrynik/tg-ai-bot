import type { BotConfig } from "../types/config.types.js";

export function createAddressCheckPrompt(botName: string): string {
  return `Ты полезный AI-ассистент по имени ${botName}. 

КРИТИЧЕСКИ ВАЖНО: Анализируй ТОЛЬКО последнее сообщение. Твоя задача - определить, обращаются ли к тебе.

Отвечай ТОЛЬКО если к тебе обращаются напрямую по имени "${botName}" или если сообщение явно адресовано тебе. 

Если сообщение НЕ адресовано тебе (не содержит твоего имени или прямого обращения к тебе), верни ТОЛЬКО слово "SKIP" без каких-либо других символов или текста. 

Если обращаются к тебе, верни ТОЛЬКО слово "ANSWER" без каких-либо других символов или текста.

НЕ ищи информацию, НЕ отвечай на вопросы - только определи, обращаются ли к тебе.`;
}

export function createSystemPrompt(
  botName: string,
  botUsername: string | null,
  mainMessage?: string
): string {
  let prompt = `Ты полезный AI-ассистент по имени ${botName}${
    botUsername ? ` (@${botUsername})` : ""
  }. Отвечай дружелюбно и по делу.`;

  if (mainMessage) {
    prompt += `\n\nВАЖНО: Пользователь отвечает на конкретное сообщение. Твой ответ должен быть СФОКУСИРОВАН на этом сообщении. Это основное сообщение, на которое нужно ответить:\n\n"${mainMessage}"\n\nОстальные сообщения ниже - это только контекст для понимания общей ситуации в беседе. Но твой ответ должен быть именно на основное сообщение выше.`;
  }

  return prompt;
}

export function createTranscriptionPrompt(
  messageText: string,
  mediaType: string
): string {
  return `Пользователь отвечает на ${mediaType} сообщение (голосовое или видео) и пишет: "${messageText}".

ВАЖНО: Если пользователь задает вопрос о содержимом ${mediaType} сообщения (например: "что тут?", "что там?", "что сказано?", "что говорит?", "что здесь?", "о чем это?", "что в этом?"), или прямо просит транскрибировать/расшифровать - это ЗАПРОС НА ТРАНСКРИПЦИЮ.

Примеры запросов на транскрипцию:
- "что тут?" - ЗАПРОС
- "что там?" - ЗАПРОС  
- "что сказано?" - ЗАПРОС
- "расшифруй" - ЗАПРОС
- "транскрипция" - ЗАПРОС
- "переведи в текст" - ЗАПРОС
- "что говорит?" - ЗАПРОС

Если это запрос на транскрипцию - верни ТОЛЬКО слово "TRANSCRIBE".
Если это НЕ запрос на транскрипцию (например, обычный вопрос или комментарий) - верни ТОЛЬКО слово "SKIP".`;
}

